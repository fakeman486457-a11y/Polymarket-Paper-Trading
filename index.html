<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polymarket Paper Trading</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

```
<script type="text/babel">
    const { useState, useEffect } = React;
    const { TrendingUp, TrendingDown, DollarSign, Calendar, Users, RefreshCw, ExternalLink } = lucide;

    const PolymarketPaperTrading = () => {
      const [balance, setBalance] = useState(10000);
      const [positions, setPositions] = useState([]);
      const [selectedMarket, setSelectedMarket] = useState(null);
      const [betAmount, setBetAmount] = useState('');
      const [betSide, setBetSide] = useState('yes');
      const [markets, setMarkets] = useState([]);
      const [loading, setLoading] = useState(true);
      const [lastUpdate, setLastUpdate] = useState(null);
      const [error, setError] = useState(null);

      const fetchPolymarketData = async () => {
        try {
          setLoading(true);
          setError(null);
          
          const response = await fetch('https://gamma-api.polymarket.com/markets?limit=20&active=true&closed=false');
          
          if (!response.ok) {
            throw new Error('Failed to fetch markets');
          }
          
          const data = await response.json();
          
          const transformedMarkets = data.map(market => ({
            id: market.condition_id,
            clob_token_ids: market.clob_token_ids || [],
            question: market.question,
            yesPrice: parseFloat(market.outcomePrices?.[0] || 0.5),
            noPrice: parseFloat(market.outcomePrices?.[1] || 0.5),
            volume: parseFloat(market.volume || 0),
            liquidity: parseFloat(market.liquidity || 0),
            endDate: market.end_date_iso ? new Date(market.end_date_iso).toLocaleDateString() : 'TBD',
            category: market.tags?.[0] || 'General',
            image: market.image,
            description: market.description,
            slug: market.slug,
            polymarketUrl: `https://polymarket.com/event/${market.slug}`
          }));
          
          setMarkets(transformedMarkets);
          setLastUpdate(new Date());
        } catch (err) {
          console.error('Error fetching Polymarket data:', err);
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      useEffect(() => {
        fetchPolymarketData();
        const interval = setInterval(fetchPolymarketData, 30000);
        return () => clearInterval(interval);
      }, []);

      useEffect(() => {
        if (positions.length > 0 && markets.length > 0) {
          setPositions(prevPositions => 
            prevPositions.map(pos => {
              const market = markets.find(m => m.id === pos.marketId);
              if (market) {
                const currentPrice = pos.side === 'yes' ? market.yesPrice : market.noPrice;
                return {
                  ...pos,
                  currentValue: pos.shares * currentPrice,
                  currentPrice: currentPrice
                };
              }
              return pos;
            })
          );
        }
      }, [markets]);

      const placeBet = () => {
        if (!selectedMarket || !betAmount || parseFloat(betAmount) <= 0) return;
        
        const amount = parseFloat(betAmount);
        if (amount > balance) {
          alert("Insufficient balance!");
          return;
        }

        const market = markets.find(m => m.id === selectedMarket);
        const price = betSide === 'yes' ? market.yesPrice : market.noPrice;
        const shares = amount / price;

        const newPosition = {
          id: Date.now(),
          marketId: selectedMarket,
          question: market.question,
          side: betSide,
          shares: shares,
          avgPrice: price,
          invested: amount,
          currentValue: shares * price,
          currentPrice: price,
          timestamp: new Date().toISOString()
        };

        setPositions([...positions, newPosition]);
        setBalance(balance - amount);
        setBetAmount('');
        setSelectedMarket(null);
      };

      const closePosition = (positionId) => {
        const position = positions.find(p => p.id === positionId);
        if (!position) return;

        const market = markets.find(m => m.id === position.marketId);
        const currentPrice = position.side === 'yes' ? market.yesPrice : market.noPrice;
        const payout = position.shares * currentPrice;

        setBalance(balance + payout);
        setPositions(positions.filter(p => p.id !== positionId));
      };

      const calculatePnL = (position) => {
        return position.currentValue - position.invested;
      };

      const totalPnL = positions.reduce((sum, pos) => sum + calculatePnL(pos), 0);
      const totalPositionValue = positions.reduce((sum, pos) => sum + pos.currentValue, 0);
      const totalValue = balance + totalPositionValue;

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white p-4 md:p-6">
          <div className="max-w-7xl mx-auto">
            <div className="mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
              <div>
                <h1 className="text-3xl md:text-4xl font-bold mb-2 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                  Polymarket Paper Trading
                </h1>
                <p className="text-gray-400 text-sm">Live markets • Virtual funds • Real practice</p>
              </div>
              
              <div className="flex items-center gap-3">
                {lastUpdate && (
                  <span className="text-xs text-gray-400">
                    Updated: {lastUpdate.toLocaleTimeString()}
                  </span>
                )}
                <button
                  onClick={fetchPolymarketData}
                  disabled={loading}
                  className="flex items-center gap-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-700 px-4 py-2 rounded-lg transition-all"
                >
                  <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />
                  Refresh
                </button>
              </div>
            </div>

            {error && (
              <div className="mb-6 bg-red-500/20 border border-red-500 rounded-lg p-4">
                <p className="text-red-200">Error loading markets: {error}</p>
              </div>
            )}

            <div className="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6 md:mb-8">
              <div className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20">
                <div className="flex items-center justify-between mb-2">
                  <span className="text-gray-400 text-xs md:text-sm">Cash Balance</span>
                  <DollarSign className="w-4 h-4 md:w-5 md:h-5 text-green-400" />
                </div>
                <div className="text-xl md:text-2xl font-bold">${balance.toFixed(2)}</div>
              </div>

              <div className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20">
                <div className="flex items-center justify-between mb-2">
                  <span className="text-gray-400 text-xs md:text-sm">Total Value</span>
                  <TrendingUp className="w-4 h-4 md:w-5 md:h-5 text-blue-400" />
                </div>
                <div className="text-xl md:text-2xl font-bold">${totalValue.toFixed(2)}</div>
              </div>

              <div className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20">
                <div className="flex items-center justify-between mb-2">
                  <span className="text-gray-400 text-xs md:text-sm">Total P&L</span>
                  {totalPnL >= 0 ? 
                    <TrendingUp className="w-4 h-4 md:w-5 md:h-5 text-green-400" /> : 
                    <TrendingDown className="w-4 h-4 md:w-5 md:h-5 text-red-400" />
                  }
                </div>
                <div className={`text-xl md:text-2xl font-bold ${totalPnL >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                  {totalPnL >= 0 ? '+' : ''}${Math.abs(totalPnL).toFixed(2)}
                </div>
              </div>

              <div className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20">
                <div className="flex items-center justify-between mb-2">
                  <span className="text-gray-400 text-xs md:text-sm">Open Positions</span>
                  <Users className="w-4 h-4 md:w-5 md:h-5 text-purple-400" />
                </div>
                <div className="text-xl md:text-2xl font-bold">{positions.length}</div>
              </div>
            </div>

            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <div className="lg:col-span-2 space-y-4">
                <h2 className="text-xl md:text-2xl font-bold mb-4">Live Markets</h2>
                
                {loading && markets.length === 0 ? (
                  <div className="text-center py-12">
                    <RefreshCw className="w-8 h-8 animate-spin mx-auto mb-4 text-purple-400" />
                    <p className="text-gray-400">Loading live markets...</p>
                  </div>
                ) : (
                  markets.map(market => (
                    <div 
                      key={market.id}
                      className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20 hover:border-purple-500/40 transition-all cursor-pointer"
                      onClick={() => setSelectedMarket(market.id)}
                    >
                      <div className="flex justify-between items-start mb-4">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-2 flex-wrap">
                            <span className="text-xs px-2 py-1 bg-purple-500/20 rounded-full text-purple-300">
                              {market.category}
                            </span>
                            <a 
                              href={market.polymarketUrl}
                              target="_blank"
                              rel="noopener noreferrer"
                              onClick={(e) => e.stopPropagation()}
                              className="flex items-center gap-1 text-xs text-blue-400 hover:text-blue-300"
                            >
                              View on Polymarket <ExternalLink className="w-3 h-3" />
                            </a>
                          </div>
                          <h3 className="text-base md:text-lg font-semibold mb-2">{market.question}</h3>
                          <div className="flex items-center gap-3 md:gap-4 text-xs md:text-sm text-gray-400 flex-wrap">
                            <div className="flex items-center gap-1">
                              <Calendar className="w-3 h-3 md:w-4 md:h-4" />
                              {market.endDate}
                            </div>
                            <div className="flex items-center gap-1">
                              <DollarSign className="w-3 h-3 md:w-4 md:h-4" />
                              ${(market.volume / 1000000).toFixed(1)}M volume
                            </div>
                          </div>
                        </div>
                      </div>

                      <div className="grid grid-cols-2 gap-3">
                        <button className="bg-green-500/20 hover:bg-green-500/30 border border-green-500/50 rounded-lg p-3 transition-all">
                          <div className="text-xs md:text-sm text-gray-300 mb-1">YES</div>
                          <div className="text-lg md:text-xl font-bold text-green-400">{(market.yesPrice * 100).toFixed(1)}¢</div>
                        </button>
                        <button className="bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 rounded-lg p-3 transition-all">
                          <div className="text-xs md:text-sm text-gray-300 mb-1">NO</div>
                          <div className="text-lg md:text-xl font-bold text-red-400">{(market.noPrice * 100).toFixed(1)}¢</div>
                        </button>
                      </div>
                    </div>
                  ))
                )}
              </div>

              <div className="space-y-6">
                <div className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20 lg:sticky lg:top-6">
                  <h2 className="text-lg md:text-xl font-bold mb-4">Place Trade</h2>
                  
                  {selectedMarket ? (
                    <>
                      <div className="mb-4 p-4 bg-purple-500/10 rounded-lg border border-purple-500/30">
                        <p className="text-xs md:text-sm text-gray-300">
                          {markets.find(m => m.id === selectedMarket)?.question}
                        </p>
                      </div>

                      <div className="mb-4">
                        <label className="block text-sm text-gray-400 mb-2">Side</label>
                        <div className="grid grid-cols-2 gap-2">
                          <button
                            onClick={() => setBetSide('yes')}
                            className={`p-3 rounded-lg font-semibold transition-all ${
                              betSide === 'yes' 
                                ? 'bg-green-500 text-white' 
                                : 'bg-slate-700 text-gray-300 hover:bg-slate-600'
                            }`}
                          >
                            YES
                          </button>
                          <button
                            onClick={() => setBetSide('no')}
                            className={`p-3 rounded-lg font-semibold transition-all ${
                              betSide === 'no' 
                                ? 'bg-red-500 text-white' 
                                : 'bg-slate-700 text-gray-300 hover:bg-slate-600'
                            }`}
                          >
                            NO
                          </button>
                        </div>
                      </div>

                      <div className="mb-4">
                        <label className="block text-sm text-gray-400 mb-2">Amount ($)</label>
                        <input
                          type="number"
                          value={betAmount}
                          onChange={(e) => setBetAmount(e.target.value)}
                          className="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-purple-500"
                          placeholder="Enter amount"
                        />
                      </div>

                      <button
                        onClick={placeBet}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 rounded-lg transition-all"
                      >
                        Place Trade
                      </button>

                      <button
                        onClick={() => setSelectedMarket(null)}
                        className="w-full mt-2 bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-lg transition-all"
                      >
                        Cancel
                      </button>
                    </>
                  ) : (
                    <p className="text-gray-400 text-center py-8">Select a market to trade</p>
                  )}
                </div>

                {positions.length > 0 && (
                  <div className="bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 md:p-6 border border-purple-500/20">
                    <h2 className="text-lg md:text-xl font-bold mb-4">Your Positions</h2>
                    <div className="space-y-3">
                      {positions.map(pos => {
                        const pnl = calculatePnL(pos);
                        const pnlPercent = (pnl / pos.invested) * 100;
                        return (
                          <div key={pos.id} className="p-3 bg-slate-700/50 rounded-lg border border-slate-600">
                            <div className="text-xs md:text-sm text-gray-300 mb-2">{pos.question}</div>
                            <div className="flex justify-between items-center mb-2">
                              <span className={`text-sm font-semibold ${pos.side === 'yes' ? 'text-green-400' : 'text-red-400'}`}>
                                {pos.side.toUpperCase()} • {pos.shares.toFixed(0)} shares @ {(pos.avgPrice * 100).toFixed(1)}¢
                              </span>
                            </div>
                            <div className="flex justify-between items-center text-sm mb-2">
                              <span className="text-gray-400">
                                ${pos.invested.toFixed(2)} → ${pos.currentValue.toFixed(2)}
                              </span>
                              <span className={pnl >= 0 ? 'text-green-400' : 'text-red-400'}>
                                {pnl >= 0 ? '+' : ''}${pnl.toFixed(2)} ({pnl >= 0 ? '+' : ''}{pnlPercent.toFixed(1)}%)
                              </span>
                            </div>
                            <button
                              onClick={() => closePosition(pos.id)}
                              className="w-full mt-2 bg-slate-600 hover:bg-slate-500 text-white text-xs py-2 rounded transition-all"
                            >
                              Close Position
                            </button>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<PolymarketPaperTrading />, document.getElementById('root'));
</script>

<script src="https://unpkg.com/lucide@latest"></script>
<script>
    lucide.createIcons();
</script>
```

</body>
</html>
